<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="UTF-8">
  <title>rspeare.github.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>


  <body>
    <section class="page-header">
  <h1 <a href="/" class="project-name">rspeare.github.io </a> </h1> 
  <h2 class="project-tagline"></h2>
  <a href="/" class="btn">Blog</a>  

  <a class="btn" <a href="https://github.com/rspeare"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">rspeare</span></a>
 </a>


  <a class="btn" <a href="https://twitter.com/waiting4spark"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">waiting4spark</span></a>
 </a>

<a href="/about/" class="btn">About</a>  
</section>


    <section class="main-content">
      
      <style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

<h2>Label Propagation and Semi-Supervised Learning: Gaussian Random Field Method</h2>
<p class="meta">29 Jan 2016</p>

<div dir="ltr" style="text-align: left;" trbidi="on">So, recently I've been 
reading up on label propagation in semi-supervised learning, which is when you 
have a great deal of data, but most of it is unlabeled. To put some notation 
on things, lets say way have a set $L$: 

\begin{eqnarray} 
L &amp;:&amp; \lbrace \mathbf{x}, y \rbrace_{n=1}^{L} 
\end{eqnarray} 

which is a set of pairs of input vectors $x$ and output labels $y$, be they 
scalar or categorical. And then we have a huge unlabeled set: 

\begin{eqnarray} 
U &amp;:&amp; \lbrace \mathbf{x}, \_\_  \rbrace_{n=1}^{U} 
\end{eqnarray} 

which we would like to infer on. Normally, this use case is motivated when the 
unlabeled set is much, much larger, $\vert L \vert &lt;&lt; \vert U \vert$. If 
we are talking about classification, one way to view this problem is through 
clustering. If we assume that close vectors $\mathbf{x}$, under some metric, 
have close labels $y$, we that might motivate a loss function of the form: 

\begin{eqnarray} 
E(\lbrace y \rbrace) &amp;=&amp; \sum_{i,j \ne i} W_{ij} (y_i - y_j)^2 
\end{eqnarray} 

Where, we're summing over all pairs of data points $i,j$, and weighting their 
difference in label with the matrix $W_{ij}$. For sanity's sake, $W_{ij}$ 
should be large when $x_i,x_j$ are close. So $W_{ij}$ goes like one over 
distance between $i,j$. For example: 

\begin{eqnarray} 
E(\lbrace y \rbrace) &amp;=&amp; \sum_{i,j \ne i} W_{ij} (y_i - y_j)^2\\ 
W_{ij} &amp;=&amp; e^{-\vert x_i - x_j \vert^2/2\sigma^2} 
\end{eqnarray} 

This weighting matrix is simply a function of the euclidean metric, and 
actually reminds one of an RBF kernel or covariance function... Is there a 
connection here? 

Absolutely. \\ 

If we frame our clustering/labeling problem as trying to minimize this loss 
function, or energy $E$, it means we can actually frame the likelihood of the 
labels with a boltzman distribution: 

\begin{eqnarray} 
P(\lbrace y \rbrace) &amp;=&amp; \frac{1}{Z}e^{-\sum_{i,j \ne i} W_{ij} (y_i - 
y_j)^2} 
\end{eqnarray} 

(Where $Z$ is the partition function, summing over all configurations of 
labels). This is extremely interesting, because if you do a little matrix 
algebra on our energy, we you find that one can re-write the loss as: 

\begin{eqnarray} 
E = \sum_{i,j\ne i} W_{ij} (y_i - y_j)^2 &amp;=&amp; \sum_{i,j\ne i} y_i 
(D_{ij}-W_{ij}) y_j \\ 
&amp;=&amp; \frac{1}{2} y_i L_{ij} y_j \\ 
D_{ii} &amp;=&amp; \sum_{j^\prime} W_{ij} \\ 
L_{ij} &amp;=&amp; \mathbf{D}-\mathbf{W} 
\end{eqnarray} 

The matrix $L_{ij}$, above is actually a close cousin of the laplacian 
operator $\nabla^2$, but we have embedded things in a high-dimensional space 
because of exponentiation. Notice that our likelihood on the configuration of 
labels now looks exactly like a Gaussian random field: 

\begin{eqnarray} 
P(\lbrace y \rbrace) &amp;=&amp; \frac{1}{Z}e^{-y_i L_{ij} y_j/2} 
\end{eqnarray} 

such that $\langle y_i \rangle =0$ and $\langle y_i y_j \rangle_c = 
L^{-1}_{ij}$. This discrete pdf on labels is precisely the same as if we had 
made everything continuous from the get-go: 

\begin{eqnarray} 
E[y(x)] &amp;=&amp; \frac{1}{2}\int dx dx^\prime y(x) y(x^\prime) 
K(x,x^\prime) \\ 
K(x,x^\prime) &amp;=&amp; e^{-\vert x-x^\prime \vert^2/2\sigma^2} \\ 
P(y(x)) &amp;=&amp; \frac{1}{Z}e^{-\frac{1}{2}\int dx dx^\prime y(x) 
y(x^\prime) K(x,x^\prime)} 
\end{eqnarray} 

which is a Gaussian random field on the labels, $y(x)$, imposing an RBF 
correlation function between points $x$. When integrate the lagrangian in by 
parts we would get the continuous equivalent of $L_{ij}$, which is essentially 
$\nabla^2$ in some new space. 

So why do we care about all of this? Well, it turns out that the algorithms 
people use to propagate labels work exactly like the Helmholtz equation. For 
instance, one of the easiest things you can do given labeled examples $L$, is 
to propagate or ``flow'' the $y$'s to unlabeled points by the following 
procedure: 

\begin{eqnarray} 
y_{t+1} &amp;=&amp; \mathbf{D}^{-1} \mathbf{W} y_t 
\end{eqnarray} 

which, is the same as the helmholtz equation: 

\begin{eqnarray} 
\left(\frac{\partial}{\partial t}+\nabla^2 \right) y_t &amp;=&amp; 0 \\ 
y_{t+1}-y_t &amp;=&amp; -\nabla^2 y_t \\ 
y_{t+1} &amp;=&amp; \left(1-\nabla^2 \right) y_t 
\end{eqnarray} 

and now note, if we replace $\nabla^2$ with $1-D^{-1/2}\mathbf{W} D^{-1/2}$, 
we get 

\begin{eqnarray} 
y_{t+1} &amp;=&amp; \mathbf{D}^{-1}\mathbf{W}  y_t 
\end{eqnarray} 

This is PRECISELY the update scheme -- in discrete form -- of Helmholtz 
dynamics, or heat diffusion. Notice that when $\frac{\partial}{\partial t}y_t 
=0$, we're going to have a Harmonic field, which is fancy word for saying the 
laplacian of the labels is zero. (this implies some other nice things, like 
all labels are the average of labels around them, the maximum of the labels y 
will always exist on the boundary, etc.) Zhu, Ghahramani and Lafferty explain 
this algorithm best when they say the labels are undergoing diffusion, with 
dirichlet -- fixed label constraints -- on the labeled points $\mathbf{x}_l$. 

Although, we are doing things not in euclidean space but somewhere else, do to 
our choice of metric. Because for instance, we could have chosen $W_{ij}$ to 
be whatever we liked, as long as it goes inverse with distance. Let 
$g(x_i,x_j)$ be some metric, then we have more generally: 

\begin{eqnarray} 
W_{ij} &amp;=&amp; f\left[g(x_i,x_j) \right] 
\end{eqnarray} 

and so $g$ defines the space in which we're taking derivatives. Things don't 
have to be euclidean! 
</div>




      <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">rspeare.github.io</a> is maintained by <a href="">rspeare</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>

  <a href="https://www.linkedin.com/in/rob-speare-aaa6834a">
    <span class="icon  icon--linkedin">
      <svg viewBox="0 0 10000 10000" >
        <path fill="#828282" d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683
        C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z
        M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615
        c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915
        s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z"/>
      </svg>
    </span>

    <span class="username"></span>
  </a>

</footer>
 

    </section>

  </body>
</html>
