<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="UTF-8">
  <title>rspeare.github.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 <a href="/" class="project-name">rspeare.github.io </a> </h1> 
  <h2 class="project-tagline"></h2>
  <a href="/" class="btn">Blog</a>  

  <a class="btn" <a href="https://github.com/rspeare"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">rspeare</span></a>
 </a>


  <a class="btn" <a href="https://twitter.com/waiting4spark"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">waiting4spark</span></a>
 </a>

<a href="/about/" class="btn">About</a>  
</section>


    <section class="main-content">
      
      <style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<h2>Multi-Dimensional Central Limit Theorem</h2>
<p class="meta">18 Feb 2014</p>

<div dir="ltr" style="text-align: left;" trbidi="on">Let us begin with the 
definition of a normalized probability distribution: 

\begin{eqnarray} 
\int_{-\infty}^{\infty} P(x) dx &amp;=&amp; 1 
\end{eqnarray} 

and a moment, 

\begin{eqnarray} 
\int_{-\infty}^{\infty} x^n P(x) dx &amp;=&amp; m_n 
\end{eqnarray} 

Notice that $m_1$ is the `mean' or average, or, `center of mass' of the 
Probability distribution. The second moment, $m_2$ is intimately related to 
the variance, or width of our distribution $P(x)$. 

We can define the moment generating function as 

\begin{eqnarray} 
\int e^{kx} P(x) dx &amp;=&amp; M(k) 
\end{eqnarray} 

Where now, taylor expanding our exponential integrand, we see that the $n^{\rm 
th}$ derivative of $M(k)$ with respect to $k$ evaluated at $k=0$, gives the 
respective moments: 

\begin{eqnarray} 
M(k) &amp;=&amp; \int e^{kx} P(x) dx\\ 
&amp;=&amp; \int \Sigma_n \frac{(kx)^n}{n!} P(x) dx \\ 
\frac{\partial^n M}{\partial k^n}\vert_{k=0} &amp;=&amp; \int x^n P(x) dx \\ 
\frac{\partial^n M}{\partial k^n}\vert_{k=0} &amp;=&amp; m_n 
\end{eqnarray} 

We can also define the moment generating function as the laplace transform of 
$P(x)$, which leaves us with an added sign convention in the definition of our 
moments, 

\begin{eqnarray} 
M^\prime (k) = \int e^{-kx}P(x) dx \\ 
(-1)^n \frac{\partial^n M^\prime}{\partial k^n}\vert_{k=0} &amp;=&amp; m_n 
\end{eqnarray} 
<pre style="-qt-block-indent: 0; margin-bottom: 0px; margin-left: 0px; 
margin-right: 0px; margin-top: 0px; text-indent: 
0px;"></pre><pre><!--EndFragment--></pre> 
Now we are in a position to define the fourier transorm of our probability 
distribution, called the characteristic function, 

\begin{eqnarray} 
M^\prime(ik) = \phi(k) &amp;=&amp; \int e^{-ikx}P(x) dx 
\end{eqnarray} 

We can simply think of $\phi(k)$ as the fourier transform of $P(x)$, and note 
that $\phi(0) =1$ always -- as required by our normalization condition above. 

Writing the inverse fourier transform, we can now write $P(x)$ in terms of 
$k-$space components, 

\begin{eqnarray} 
P(x) &amp;=&amp; \frac{1}{2\pi}\int e^{ikx} \phi(k) dk \\ 
 &amp;=&amp; \frac{1}{\pi}\int e^{ikx} e^{\log\left(\phi(k)\right)}dk 
\end{eqnarray} 

Where I have used the $\frac{1}{2 \pi}$ for inverse fourier normalization 
conventions (not the same as the QM convention!). 

I would now like to define cumulants which, are the corresponding derivatives 
of the $\psi(k)=\log\left(\phi(k)\right)$ function, seen the exponential 
argument of the above equation. First, notice that under the fourier 
transform, multiplication in x-space is differentiation in k-space, i.e. 

\begin{eqnarray} 
\mathcal{F}\left[ xP(x) \right] &amp;=&amp; (-i)\frac{\partial \phi}{\partial 
k} 
\end{eqnarray} 

and so we find that the various moments can be defined by the partial 
derivatives of the characteristic function (not much different than what we 
did before with the moment generating function $M^\prime$, under simply a 
change of variable): 

\begin{eqnarray} 
m_n &amp;=&amp; (-i)^n \frac{\partial^n \phi}{\partial k^n}\vert_{k=0} 
\end{eqnarray} 

Using our $\psi(k)$ function from before, we can now define the cumulants 

\begin{eqnarray} 
c_n &amp;=&amp; (i)^n \frac{\partial^n \psi}{\partial k^n}\vert_{k=0} 
\end{eqnarray} 

which, can be constructed out of our initial moments, 

\begin{eqnarray} 
c_1 &amp;=&amp; m_1 \\ 
c_2 &amp;=&amp; m_2-m_1^2\\ 
c_3 &amp;=&amp; m_2-3m_2m_1+2m_1^2\\ 
c_4 &amp;=&amp; m_4-4m_3m_1-3m_2^2+12m_2m_1^2-6m_1^2 
\end{eqnarray} 

Notice that the first cumulant is our standard mean, or average, and that the 
second cumulant is our definition of variance, or the expectation value of 
difference from the mean. (i.e. $c_1=\bar{x}$ and $c_2 
=\sigma^2=E[(x-\bar{x})^2]$). These cumulants are very good descriptors of a 
statistical distribution because they add under convolution. Let's take a 
closer look. 

Under the fourier transform, convolution in x-space is multiplication in 
k-space -- see convolution theorem -- and so cumulants and cumulant-generating 
functions add under convolution. In probability theory, when one adds two 
statistically independent variables $x$ and $y$ in order to create a new 
variable $z=x+y$, then the probability distribution that describes $z$ is the 
convolution of the two former probability distributions: $P(z) = \left(P_x 
\star P_y\right)(z)$. Let's see what such an addition would do in fourier 
space, 

\begin{eqnarray} 
P(z) &amp;=&amp; \left(P_x \star P_y\right)(z) \\ 
&amp;=&amp; \mathcal{F}^{-1}\left[ \phi_x(k)\phi_y(k) \right]\\ 
&amp;=&amp; \frac{1}{2\pi}\int e^{i k x} \phi_x(k)\phi_y(k) dk \\ 
&amp;=&amp; \frac{1}{2\pi}\int e^{i k x} e^{\log\left(\phi_x(k)\right)}e^{\log 
\left(\phi_y(k)\right)}dk \\ 
&amp;=&amp; \frac{1}{2\pi}\int e^{i k x} e^{\psi_x(k)+\psi_y(k)}dk \\ 
\end{eqnarray} 

Expanding both cumulant-generating functions as a taylor series, and 
collecting like powers of $k$, we find 

\begin{eqnarray} 
P(z) &amp;=&amp; \frac{1}{2\pi}\int e^{i k x} 
e^{-ic_{1x}k-c_{2x}k^2/2+ic_{3x}\frac{k^3}{3!}+\dots}e^{-ic_{1y}k-c_{2y}k^2/2+ic_{3y}\frac{k^3}{3!}+\dots}dk 
\\ 
&amp;=&amp; \frac{1}{2\pi}\int e^{i k x} 
e^{-i(c_{1x}+c_{1y})k-(c_{2x}+c_{2y})k^2/2+i(c_{3x}+c_{3y})\frac{k^3}{3!}+\dots}dk 
\\ 
\end{eqnarray} 

Notice that $c_{1z}= c_{1x}+c_{1y}$ and $c_{2z}= c_{2x}+c_{2y}$, or the mean 
is the sum of the two former means, and the variance is the sum of the two 
former variances. Very cool! 

Under what are called identically independent processes, such as random walks, 
we have a new variable $z=\sigma x_i$, which is a superposition of independent 
variables that are described by the exact same probability density function. 
In this case, our expectation value -- or first moment -- for the variable $z$ 
becomes $Nm_{1z}=N\bar{x}$, where $N$ is the number of `steps' or `trials' 
taken. Similarly we find that the variance of the sum of random variables is 
$\sigma^2_z = N \sigma^2_x$. Or the variance grows as $\sqrt{N}$. 

The central limit theorem depends intimately upon this addition of cumulants 
under convolution, and uses the inverse properties of expansion and dilation 
under the fourier transform to truncate the taylor expansion of our effective 
cumulant generating functions. Let's take a look at an `iid' process, or 
$P(z)$, where $z=\Sigma x_i$. 

\begin{eqnarray} 
P(z) &amp;=&amp; \frac{1}{2\pi} \int e^{ikz}\Pi_{i=1}^N \phi_i(k) dk \\ 
P(z) &amp;=&amp; \frac{1}{2\pi} \int e^{ikz}e^{\Sigma_i \psi_i(k)} dk \\ 
P(z) &amp;=&amp; \frac{1}{2\pi} \int e^{ikz}e^{\Sigma_i \left( 
-ic_{1i}\right)-ik}e^{\Sigma_i \left( -c_{2i}\right)\frac{-k^2}{2}}+\cdots dk 
\end{eqnarray} 

As we convolve more and more probability density functions, our variances will 
add, and we will end up with an extremely wide density function. In fourier 
space, this corresponds to an extremely narrow characteristic function, and 
allows us to assume negligible value of $\phi(k)$ at high $k$-values. Thus, we 
can write 

\begin{eqnarray} 
\psi(k) &amp;=&amp; -ic_1 k - 
c_2\frac{k^2}{2}+ic_3\frac{k^3}{3!}-c_4\frac{k^4}{4!}+\dots 
\end{eqnarray} 

as 

\begin{eqnarray} 
\psi(k) &amp;\approx &amp; -ic_1 k - c_2\frac{k^2}{2} 
\end{eqnarray} 

Taking this into account -- and noting that the $c_1$ and $c_2$ are in fact 
sums of former means and variances under convolution -- we can now write 
$P(z)$ as, 

\begin{eqnarray} 
P(z) &amp;=&amp; \frac{1}{2 \pi} \int e^{ikz}e^{-ic_1 k}e^{-c_2 
\frac{k^2}{2}}dk \\ 
P(z) &amp;=&amp; \frac{1}{2 \pi} \int e^{ikz}e^{-ic_1 k}e^{-c_2 
\frac{k^2}{2}}dk 
\end{eqnarray} 

Setting $z^\prime = z-c_1$, or, centering about the mean we can exclude the 
first exponential and write 

\begin{eqnarray} 
P(z^\prime) &amp;=&amp; \frac{1}{2 \pi} \int e^{ikz^\prime}e^{-c_2 
\frac{k^2}{2}}dk 
\end{eqnarray} 
<div> 

This is the fourier transform of a gaussian, which is itself a gaussian, 

\begin{eqnarray} 
P(z^\prime) &amp;=&amp; \frac{1}{\sqrt{2 \pi c_2}}e^{\frac{-z^2}{2c_2}}\\ 
P(z) &amp;=&amp; \frac{1}{\sqrt{2 \pi 
\sigma^2}}e^{\frac{-(z-c_1)^2}{2\sigma^2}}\\ 
P(z) &amp;=&amp; \frac{1}{\sqrt{2 \pi 
\sigma^2}}e^{\frac{-(z-\bar{z})^2}{2\sigma^2}} 
\end{eqnarray} 

Whew! Notice that our mean and variance in this final equation are simply the 
sums of former means and variances of the independent variables, $x_i$ that 
created $z$. ($z = \Sigma_i x_{i}$  ;  $c_1 = \Sigma_i c_{1i}$  ;  $c_2 = 
\Sigma_i c_{2i}$). The central limit theorem does not depend on each of these 
variables -- perhaps $N$ of them -- being identical, or, described by the same 
probability density function, they need only be independent. 

Now, extrapolation to multiple dimension is not to bad, we now deal with 
random vectors as compared to random scalars. Let's represent these vectors 
with boldface, and label their components with a superscript. We can now write 

\begin{eqnarray} 
\mathbf{z} &amp;=&amp; \Sigma_j \mathbf{x^j} 
\end{eqnarray} 

Where the superscript denotes the $j^{\rm th}$ independent random vector. 
Similarly, our $k$ space is now multidimensional, and so we write the forward 
fourier transform of our probability density as 

\begin{eqnarray} 
\phi(\mathbf{k}) &amp;=&amp; \int e^{i\mathbf{k}\cdot 
\mathbf{x}}P(\mathbf{x})d^d\mathbf{x} \\ 
\phi(\mathbf{k}) &amp;=&amp; \int 
e^{i\mathbf{k_i}\mathbf{x_i}}P(\mathbf{x})d^d\mathbf{x} 
\end{eqnarray} 

The cumulants and the moments are now rank $n$ tensors, seen by the following 

\begin{eqnarray} 
\frac{\partial^n M}{\partial \mathbf{k}_i \partial \mathbf{k}_j \cdots 
\partial \mathbf{k}_\gamma}\vert_{\mathbf{k}=0} &amp;=&amp; (-i)^n 
\mathbf{m}_{ij\cdots \gamma} \\ 
\frac{\partial^n \psi}{\partial \mathbf{k}_i \partial \mathbf{k}_j \cdots 
\partial \mathbf{k}_\gamma}\vert_{\mathbf{k}=0} &amp;=&amp; (-i)^n 
\mathbf{c}_{ij\cdots \gamma} 
\end{eqnarray} 

We now use the same approximation scheme as before, convolving an absurd 
number of multi-dimensional probability density functions, $P(\mathbf{x}_i)$ 
in order to yield a convolution in fourier space -- and thus an addition of 
cumulant generating functions 

\begin{eqnarray} 
P(\mathbf{z}) &amp;=&amp; \frac{1}{(2\pi)^d}\int e^{i\mathbf{k}\cdot 
\mathbf{z}}e^{\Sigma \psi_i(\mathbf{k})}d^d\mathbf{k}\\ 
P(\mathbf{z}) &amp;=&amp; \frac{1}{(2\pi)^d}\int e^{i\mathbf{k}\cdot 
\mathbf{z}}e^{-i \mathbf{c}_i \mathbf{k}_i)}e^{-i\mathbf{k}_i \mathbf{c}_{ij} 
\mathbf{k}_j)}e^{-i \mathbf{c}_{ijk} \mathbf{k}_i \mathbf{k}_j 
\mathbf{k}_k)}\cdots d^d\mathbf{k}\\ 
\end{eqnarray} 

Truncating our taylor expansion and centering about the multidimensional mean 
$\mathbf{z}_i^\prime = \mathbf{z}_i - \mathbf{c}_i $, 

\begin{eqnarray} 
P(\mathbf{z}^\prime) &amp;=&amp; \frac{1}{(2\pi)^d}\int e^{i\mathbf{k}\cdot 
\mathbf{z}^\prime}e^{-i\mathbf{k}_i \mathbf{c}_{ij} 
\mathbf{k}_j)}d^d\mathbf{k}\\ 
\end{eqnarray} 

We can rescale coordinates by writing 

\begin{eqnarray} 
\mathbf{w} &amp;=&amp; \sqrt{\mathbf{c}_{ij}}\mathbf{k}_j 
\end{eqnarray} 

where, the square of a matrix can be written terms of its diagonalization by 
two unitary matrices $\mathbf{S}_{ij}$, and the diagonal matrix of eigenvalues 
$\mathbf{\Lambda}_{ij} = \delta_{ij}\lambda_i$, 

\begin{eqnarray} 
\mathbf{c}_{ij} &amp;=&amp; \mathbf{S}^{-1} \mathbf{\Lambda}\mathbf{S} \\ 
\mathbf{c}_{ij} &amp;=&amp; \mathbf{S}_{il} \lambda_l \delta_{lm} 
\mathbf{S}_{lj} \\ 
\sqrt{\mathbf{c}_{ij}} &amp;=&amp; \mathbf{S}_{il} \sqrt{\lambda_l} 
\delta_{lm} \mathbf{S}_{lj} \\ 
\mathbf{w} &amp;=&amp; \sqrt{\mathbf{c}_{ij}}\mathbf{k}_j 
\end{eqnarray} 

The determinant of this matrix will be the product of the eigenvalues 
$\lambda_j$, which is also the dilating factor by which one expands a single 
$\mathbf{k}$ vector; so  we can now write our infinitesimal volume element in 
$d$-dimensional $\mathbf{k}$ space using this determinant, 

\begin{eqnarray} 
d^d \mathbf{w} &amp;=&amp; \left( \vert \mathbf{c}_{ij} \vert \right)^{d/2} 
d^d\mathbf{k} 
\end{eqnarray} 

Now rewriting our integral, we have a multi-dimensional transform of a 
Gaussian, which is another Gaussian 

\begin{eqnarray} 
P(\mathbf{z}^\prime) &amp;=&amp; \frac{1}{(2\pi)^d} \int e^{i 
\frac{\mathbf{w}_j}{\sqrt{\mathbf{c_{ij}}}} 
\mathbf{z}_i^\prime}e^{-\frac{\mathbf{w}_i  
\mathbf{w}_i}{2}}\frac{d^d\mathbf{w}}{\vert \mathbf{c}_{ij} \vert^{d/2}}\\ 
P(\mathbf{z}^\prime)  &amp;=&amp; \frac{1}{(2\pi \vert \mathbf{c}_{ij} 
\vert)^{d/2}} 
\mathrm{exp}\left(-\frac{1}{2}\frac{\mathbf{z^\prime}_l}{\mathbf{c}_{il}}\frac{\mathbf{z^\prime}_\gamma}{\mathbf{c}_{i 
\gamma}}\right) 
\end{eqnarray} 

Whew! The argument in the exponential -- namely, those nasty matrix 
multiplications into the second cumulant matrices -- can be simplified, 
yielding a single covariance matrix on the bottom. 

\begin{eqnarray} 
P(\mathbf{z}^\prime)  &amp;=&amp; \frac{1}{(2\pi \vert \mathbf{c}_{ij} 
\vert)^{d/2}} 
\mathrm{exp}\left(-\frac{1}{2}\frac{\mathbf{z^\prime}_l}{\mathbf{c}_{il}}\frac{\mathbf{z^\prime}_\gamma}{\mathbf{c}_{i 
\gamma}}\right) 
\end{eqnarray} 
</div></div>




      <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">rspeare.github.io</a> is maintained by <a href="">rspeare</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>

  <a href="https://www.linkedin.com/in/rob-speare-aaa6834a">
    <span class="icon  icon--linkedin">
      <svg viewBox="0 0 10000 10000" >
        <path fill="#828282" d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683
        C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z
        M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615
        c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915
        s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z"/>
      </svg>
    </span>

    <span class="username"></span>
  </a>

</footer>
 

    </section>

  </body>
</html>
