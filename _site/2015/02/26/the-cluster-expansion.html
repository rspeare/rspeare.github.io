<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="UTF-8">
  <title>rspeare.github.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
  
</head>


  <body>
    <section class="page-header">
  <h1 <a href="/" class="project-name">rspeare.github.io </a> </h1> 
  <h2 class="project-tagline"></h2>
  <a href="/" class="btn">Blog</a>  

  <a class="btn" <a href="https://github.com/rspeare"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">rspeare</span></a>
 </a>


  <a class="btn" <a href="https://twitter.com/waiting4spark"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">waiting4spark</span></a>
 </a>

<a href="/about/" class="btn">About</a>  
</section>


    <section class="main-content">
      
      <style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

<h2>The Cluster Expansion and "Connected" Cumulants</h2>
<p class="meta">26 Feb 2015</p>

<div dir="ltr" style="text-align: left;" trbidi="on"> 
Something that has been bothering me for a long time is the diagrammatic 
connection between moments and the connected moments. Or the moments of a 
distribution and the cumulants: 

\begin{eqnarray} 
\langle x \rangle \sim \langle x \rangle_c 
\end{eqnarray} 

The simplest way to deal with this is to write the moment generating function 
and cumulant generating function in a Taylor series. For the moment generating 
function, or should I say characteristic function we have: 

\begin{eqnarray} 
\phi(k) &amp;=&amp; \int P(x) e^{ikx}dx \\ 
&amp;=&amp; \sum_{n=0}^\infty \frac{(-ik)^n}{n!}\langle x^n \rangle 
\end{eqnarray} 

and for the cumulant generating function: 

\begin{eqnarray} 
\psi(k) &amp;=&amp; \log \phi(k) \\ 
&amp;=&amp;  \sum_{n=0}^\infty \frac{(-ik)^n}{n!}\langle x^n \rangle_c 
\end{eqnarray} 

Equating these two expressions, we have 

\begin{eqnarray*} 
\sum_{n=0}^\infty \frac{(-ik)^n}{n!}\langle x \rangle &amp;=&amp; 
e^{\sum_{n=0}^\infty \frac{(-ik)^n}{n!}\langle x^n \rangle_c} 
\end{eqnarray*} 

The sum in the exponential on the right hand side is really just a product, 
which I can write as: 

\begin{eqnarray*} 
\sum_{m=0}^\infty \frac{(-ik)^m}{m!}\langle x^m \rangle &amp;=&amp; 
\prod_{n=1}^\infty \left( e^{\frac{(-ik)^n}{n!}\langle x^n \rangle_c }\right) 
\\ 
&amp;=&amp;\prod_{n=1}^\infty  \left( \sum_p 
\frac{(-ik)^{np}}{p!(n!)^p}\langle x^n \rangle_c^p \right) 
\end{eqnarray*} 

So this is an interesting comparison. Since both expansions rely on certain 
powers -- or should I say a certain number of derivatives -- of $k$. If we 
equate the two sides under the condition 

\begin{eqnarray} 
\sum p n = m 
\end{eqnarray} 

where, $p$ is different for every $n$, so we had better write: 

\begin{eqnarray} 
\sum p_n n = m 
\end{eqnarray} 

we get: 

\begin{eqnarray*} 
\langle x^m \rangle &amp;=&amp; \sum_{\lbrace p_n \rbrace}m! 
\prod_{n=1}^\infty \frac{1}{p_n! (n!)^{p_n}}\langle x^n \rangle_c^{p_n} 
\end{eqnarray*} 

Where we sum over the set $p_n \epsilon \lbrace p \rbrace $ that satisfies 
$\sum p_n n = m$. Kardar says that this combinatoric factor is just the number 
of ways we can break up $m$ objects into $p_n$ clusters, each of $n$ 
components. When you think about it, this works. Take four points and split 
them into one cluster of two points, $p_2=1$ and two ``clusters'' of one 
point, $p_1=2$. We satisfy $\sum p_n n = m$ since $p_2+p_1=4$. Now, the 
points, as a whole, can be ordered in $4!$ ways, but once we bunch them into 1 
cluster of $2$ points, we find that those remaining two points are 
indistinguishable ``inside the cluster''. So we get a combinatoric factor of 
6. Similarly, there are 3 ways of breaking four points into two clusters of 
two points, one way of breaking four points into four clusters of four points, 
one way of breaking four points into one cluster of four points, etc. 

You could go on and on like this until your head falls off. But this finally 
makes explicit -- and, kind of intuitive -- the connection between cumulants 
and moments. 

So, the question becomes, \textbf{**why define cumulants anyway**}? 
\textbf{**What are their properties**}? One of the things I've learned is that 
cumulants add under convolution, so when we add two random variables, and 
thereby convolve their probability densities, we get a multipliciation of the 
characteristic functions (by the convolution theorem). And this means that 

\begin{eqnarray} 
P(z=x_1+x_2) &amp;=&amp; P(x_1) \star P(x_2) = \int P(\tau)P(z-\tau)d \tau  \\ 
\phi(k_1,k_2) &amp;=&amp; \phi(k_1)\phi(k_2) = e^{\psi(k_1)+\psi(k_2)} 
\end{eqnarray} 

So cumulants, as I'm beginning to learn in Thermodynamics are 
\textbf{**extensive**}. The cumulant generating function itself is 
\textbf{**extensive**}. Just like the partition function $Z$ is 
\textbf{**extensive**}. This extensivity property has very deep implications 
because when we take the average of a sum of independently identically 
distributed random variables: 

\begin{eqnarray} 
Z &amp;=&amp; \frac{x_1+x_2+\dots x_N}{N} 
\end{eqnarray} 

The cumulant generating function of that sum goes like the sum as well: 

\begin{eqnarray} 
\psi(k) &amp;=&amp; \sum_{i=1}^N \psi_i(k) 
\end{eqnarray} 

and therefore, the variance of the mean is not extensive but inversely 
extensive, as many many mathematicians know because of the law of large 
numbers: 

\begin{eqnarray} 
\sigma^2_{x_1+x_2+\dots} &amp;=&amp; N \sigma_{x} \\ 
\sigma^2_Z &amp;=&amp; \frac{\sigma^2}{N} 
\end{eqnarray} 

Higher order cumulants, as $N$ gets large will vanish even faster: 

\begin{eqnarray} 
\langle Z^n \rangle_c \sim \frac{1}{N^{n-1}} 
\end{eqnarray} 

And this is another way to prove the the law of large numbers. All higher 
order cumulants will diminish faster than $\frac{1}{N}$, so the leading order 
contribution comes from variance. This convergence of averages is a very 
powerful tool in Statistical mechanics, where $N$ is absurdly large, like 
$10^{23}$. 

------------------------------------------ 

The central limit theorem, I am still convinced, relies on something else, 
which is the boundedness above of the characteristic function $\phi(k)$ by 
unity. Under many many multiplications, this multivariate $\phi(k)$ collapses 
about the origin, and one is well justified in Taylor expanding in $k$ only to 
second order, which is, a Gaussian. 

----------------------------------------- 

Now back to this cluster expansion. This formula, the combinatoric factor for 
breaking $m$ balls into $p_n$ clusters of $n$ constituents is a very important 
concept, because it is, in the multivariate case, what underlies Wick's 
theorem in field theory. Field Theory is so heavily based on Gaussian 
statistics because all free fields have Gaussian properties, so it is often 
easy to forget how to generally break down a multi-variate cumulant, but the 
key lies in this cluster expansion. 

Let's see if we can do the cluster expansion in the multi-variate case. The 
characteristic function can be expanded as 

\begin{eqnarray} 
\phi(\vec{k}) &amp;=&amp; \sum_{m=0}^\infty \frac{(-i)^m}{m!} \prod_{i=1}^N 
\left(k_i^{m_i}\right)\langle x_1^{m_1}x_2^{m_2}\dots x_N^{m_N} \rangle 
\end{eqnarray} 

equating this with the cumulant generating function, we get something quite 
nasty: 

\begin{eqnarray*} 
\phi(\vec{k}) &amp;=&amp; \prod_{n=1}^\infty \left(\sum_{p_n=0}^\infty 
\frac{(-i)^{np_n}}{(n!)^{p_n}p_n!} \left(\prod_{i=1}^N k_i^{n_i}\right)^{p_n} 
\langle x_1^{n_1}x_2^{n_2}\dots x_N^{n_N} \rangle_c \right) 
\end{eqnarray*} 

Equating like powers of $k_1,k_2,k_3,\dots$ separately, I get the condition 

\begin{eqnarray} 
\sum_n p_n n_i &amp;=&amp; m_i \ \forall i \epsilon [1,N] \\ 
\sum_n p_n n &amp;=&amp; m 
\end{eqnarray} 

Which is equivalent of saying, in each expectation value, we require the same 
total number of random variables and the same number of each type of random 
variable $x_i$. The combinatoric factors in this case might be tricky, since 
we are equating: 

\begin{eqnarray*} 
\sum_{m=0}^\infty \frac{(-i)^m}{m!} \prod_{i=1}^N 
\left(k_i^{m_i}\right)\langle x_1^{m_1}x_2^{m_2}\dots x_N^{m_N} \rangle 
&amp;=&amp; \prod_{n=1}^\infty \left(\sum_{p_n=0}^\infty 
\frac{(-i)^{np_n}}{(n!)^{p_n}p_n!} \left(\prod_{i=1}^N k_i^{n_i}\right)^{p_n} 
\langle x_1^{n_1}x_2^{n_2}\dots x_N^{n_N} \rangle_c^{p_n} \right) 
\end{eqnarray*} 

When we look at the requirement $\sum_i n_i = n$, we realize that there are 
$\frac{n!}{n_1! n_2! \cdots n_N!}$ ways -- a multinomial combinatoric -- to do 
this. So each term on the right should be weighted by this factor: 

\begin{eqnarray*} 
\langle x_1^{m_1}x_2^{m_2}\dots x_N^{m_N} \rangle &amp;=&amp; \sum_{\lbrace p 
\rbrace} m! \prod_{n=1}^\infty \left(\frac{1}{(n!)^{p_n}p_n!} 
\left(\frac{n!}{n_1! n_2! \cdots n_N!} \right) \langle x_1^{n_1}x_2^{n_2}\dots 
x_N^{n_N} \rangle_c^{p_n} \right) 
\end{eqnarray*} 

This is an intimidating formula, and may not be correct. 
</div>




      <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">rspeare.github.io</a> is maintained by <a href="">rspeare</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>

  <a href="https://www.linkedin.com/in/rob-speare-aaa6834a">
    <span class="icon  icon--linkedin">
      <svg viewBox="0 0 10000 10000" >
        <path fill="#828282" d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683
        C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z
        M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615
        c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915
        s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z"/>
      </svg>
    </span>

    <span class="username"></span>
  </a>

</footer>
 

    </section>

  </body>
</html>
